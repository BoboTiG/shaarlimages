var linearPartitionTable=function(e,t){"use strict";var i,n,r,a=e.length,o=[],s=[],l=[],c=[],d={computed:1/0,value:1/0};for(i=0;a>i;i+=1){for(o=[],n=0;t>n;n+=1)o.push(0);s.push(o)}for(i=0;a-1>i;i+=1){for(o=[],n=0;t-1>n;n+=1)o.push(0);l.push(o)}for(i=0;a>i;i+=1)s[i][0]=e[i]+(i?s[i-1][0]:0);for(i=0;t>i;i+=1)s[0][i]=e[0];for(i=1;a>i;i+=1)for(n=1;t>n;n+=1){for(c=[],r=0;i>r;r+=1)c.push([Math.max(s[r][n-1],s[i][0]-s[r][0]),r]);for(d={computed:1/0,value:1/0},r=0;i>r;r+=1)c[r][0]<d.computed&&(d={value:c[r],computed:c[r][0]});s[i][n]=d.value[0],l[i-1][n-1]=d.value[1]}return[s,l]},linearPartition=function(e,t){"use strict";var i,n,r,a=e.length-1,o=[],s=[],l=[];if(1>t)return s;if(t>a){for(i=0;a>=i;i+=1)s.push([e[i]]);return s}for(n=linearPartitionTable(e,t),r=n[1],t-=2;t>=0;){for(l=[],i=r[a-1][t]+1;a>=i;i+=1)l.push(e[i]);l=[l],o=l.concat(o),a=r[a-1][t],t-=1}for(i=0;a>=i;i+=1)s.push(e[i]);return s=[s],s.concat(o)},linearPartitionFitPics=function(e,t){"use strict";t.border=t.border||0,t.spacing=t.spacing||0;var i,n,r,a,o,s,l,c,d=0,u=0,h=0,p=[],f=[];for(i=0,r=e.length;r>i;i+=1)e[i].aspectRatio=e[i].width/e[i].height,u+=e[i].aspectRatio*t.preferedImageHeight;if(o=Math.round(u/t.containerWidth),o>e.length&&(o=e.length),1>=o)for(i=0,r=e.length;r>i;i+=1)e[i].width=parseInt(t.preferedImageHeight*e[i].aspectRatio,10),e[i].height=t.preferedImageHeight;else{for(i=0,r=e.length;r>i;i+=1)p.push(parseInt(100*e[i].aspectRatio,10));a=linearPartition(p,o);for(i in a){for(s=a[i],l=t.containerWidth,h=0,f=[],r=s.length,t.spacing&&(l-=t.spacing*(r-1)),n=0;r>n;n+=1)f.push(e[d]),d+=1;for(n=0,r=f.length;r>n;n+=1)h+=f[n].aspectRatio;for(n=0;r>n;n+=1)c=f[n],c.width=parseInt(l/h*c.aspectRatio,10),c.height=parseInt(l/h,10),n===r-1&&(c.last=!0)}}return e},parse_query_string=function(){"use strict";var e=window.location.search,t={};return e.replace(new RegExp("([^?=&]+)(=([^&]*))?","g"),function(e,i,n,r){t[i]=r}),t},params=parse_query_string();if(params.i){var x=document.documentElement.clientWidth,y=document.documentElement.clientHeight,img=document.getElementsByTagName("figure")[0].getElementsByTagName("img")[0],ix=img.offsetWidth,iy=img.offsetHeight,need_change=ix>=x||iy>=y;need_change&&(ix>=x&&(img.style.borderLeft="none",img.style.borderRight="none"),iy>=y&&(img.style.borderTop="none",img.style.borderBottom="none"))}else linear_me=function(){"use strict";var e,t,i=document.getElementById("image-container").getElementsByTagName("figure"),n=i.length,r=[];if(0===r.length){var a=new Image;for(e=0;n>e;e+=1)a.src=i[e].getElementsByTagName("img")[0].src,r.push({originalImage:i[e].getElementsByTagName("img")[0],width:a.width,height:a.height})}var o=linearPartitionFitPics(r,{containerWidth:document.documentElement.clientWidth-16,preferedImageHeight:parseInt(document.documentElement.clientHeight/2,10),spacing:4});for(e=0,n=r.length;n>e;e+=1)t=r[e],t.originalImage.height=o[e].height,t.originalImage.width=o[e].width,t.last||(i[e].style.marginRight="4px")},window.onload=linear_me,window.onresize=linear_me;
